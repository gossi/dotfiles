# Options to make tmux more pleasant
set -g default-terminal "tmux-256color"
set -g allow-passthrough on # terminal escape sequences (such as for images)

# mouse support
set -g mouse on
bind -n MouseDrag1Status swap-window -t=

# reload with leader + r
unbind r
bind r source-file ~/.config/tmux/tmux.conf

# Leader key to be ctrl + space
# https://stackoverflow.com/questions/67320205/binding-prefix-to-c-space-in-tmux-doesnt-work-when-you-have-nested-sessions
unbind C-b
set -g prefix C-Space
bind C-Space send-prefix

# Start windows and panes at 1, not 0
set -g base-index 1
set -g pane-base-index 1
set-window-option -g pane-base-index 1
set-option -g renumber-windows on

# Keybindings

# show session with <leader> s
# https://darren.sh/cli/dev-term-setup/#rebind-show-session
bind-key Space choose-tree -s

# bindings for window and pain management use function keys. 
# That is ghostty maps cmd + key to that function key.
# (Tmux wouldn't understand cmd by itself)

# window management
bind -n F1 new-session # cmd + n
bind -n F2 new-window -c "#{pane_current_path}" # cmd + t
bind -n F3 kill-pane # cmd + w

# windows cmd + 1 -> cmd + 9
bind -n M-1 selectw -t 1
bind -n M-2 selectw -t 2
bind -n M-3 selectw -t 3
bind -n M-4 selectw -t 4
bind -n M-5 selectw -t 5
bind -n M-6 selectw -t 6
bind -n M-7 selectw -t 7
bind -n M-8 selectw -t 8
bind -n M-9 selectw -t 9

# pane management
bind -n F4 split-window -h -c "#{pane_current_path}" # cmd + d
bind -n F5 split-window -v -c "#{pane_current_path}" # cmd + D
bind -n F6 select-pane -L # cmd + alt + ←
bind -n F7 select-pane -D # cmd + alt + ↑
bind -n F8 select-pane -U # cmd + alt + →
bind -n F9 select-pane -R # cmd + alt + ↓
bind -n F10 resize-pane -Z # cmd + shift + enter

# Configure the catppuccin plugin 
set -g @catppuccin_flavor "macchiato" 
set -g @catppuccin_window_status_style "rounded"

run '~/.config/tmux/plugins/tmux/catppuccin.tmux'

# Status
set-option -g status-position top
set -g @catppuccin_window_flags "icon"
set -g @catppuccin_window_flags_icon_last "" # -
set -g @catppuccin_window_flags_icon_current "" # *
set -g @catppuccin_window_text " #W"
set -g @catppuccin_window_current_text " #W"
# set -g @catppuccin_directory_text " #(starship module directory)"
set -g status-left "#{E:@catppuccin_status_session}#[bg=#{@_ctp_status_bg}] #[none]"
set -g status-left-length 350
set -g @catppuccin_status_right_separator "#[fg=#{@_ctp_status_bg},reverse]#[bg=#{@_ctp_status_bg}]#[none]"
set -g status-right "#{E:@catppuccin_status_directory} #{E:@catppuccin_status_application}"
#set -g status-right "#{E:@catppuccin_status_application}"
#set -g status-right "#{E:@catppuccin_status_pane_current_path} #{E:@catppuccin_status_application}"

# vim-tmux navigation
set -g @vim_navigator_mapping_left "F6" # cmd + alt + ←
set -g @vim_navigator_mapping_down "F7" # cmd + alt + ↑
set -g @vim_navigator_mapping_up "F8" # cmd + alt + →
set -g @vim_navigator_mapping_right "F9" # cmd + alt + ↓ 
set -g @vim_navigator_mapping_prev ""  # removes the C-\ binding

# Plugins

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'catppuccin/tmux'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'tmux-plugins/tmux-sessionist'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @resurrect-capture-pane-contents 'on'
set -g @continuum-restore 'on'

run '~/.config/tmux/plugins/tpm/tpm'

